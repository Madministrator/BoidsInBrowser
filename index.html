<!doctype html>
<html lang="en">

<head>
	<title>BoidsInBrowser</title>
	<style>
		canvas {
			border: solid thick black;
			margin-left: auto;
			margin-right: auto;
		}
		button {
			display:block;
		}
	</style>
</head>

<body>
	<canvas id="boids" style="width: 95%"></canvas>
	<button onClick="pause()">Pause</button>
	<button onClick="play()">Play</button>
	<button onClick="addBoid()">Add a Boid</button>
	<script src="Boid.js"></script>
	<script src="Flock.js"></script>
	<script>
		let canvas = document.getElementById('boids')
		let context = canvas.getContext('2d')

		let flock = new Flock(canvas, window, 1)
		flock.verbosity.vision = true
		flock.verbosity.v1 = true
		flock.verbosity.decision = true
		flock.verbosity.d1 = true
		let raf // for animation
		
		function animate() {
			flock.step()
			raf = window.requestAnimationFrame(animate)
		}

		function addBoid() {
			flock.addRandomBoid()
		}

		function play() {
			raf = window.requestAnimationFrame(animate)
		}

		function pause() {
			window.cancelAnimationFrame(raf)
		}

		function testRules() {
			let testFlock = new Flock(canvas, window, 1)
			testFlock.verbosity.vision = true
			testFlock.verbosity.decision = true
			testFlock.boids = []

			let x = canvas.width / 2
			let y = canvas.height / 2
			const d = 50
			testFlock.addBoid(x, y)
			testFlock.addBoid(x - d, y - d, Math.PI) // top left
			testFlock.addBoid(x, y - d, Math.PI) // top
			testFlock.addBoid(x + d, y - d, Math.PI) // top right
			testFlock.addBoid(x - d, y, Math.PI) // left
			testFlock.addBoid(x + d, y, Math.PI) // right
			testFlock.addBoid(x - d, y + d, Math.PI + 1) // bottom left
			testFlock.addBoid(x, y + d, Math.PI + 1) // bottom
			testFlock.addBoid(x + d, y + d, Math.PI) // bottom right
			
			testFlock.step()
		}

		testRules()

		// play()

	</script>
</body>

</html>